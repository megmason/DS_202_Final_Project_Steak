---
title: "Final Project Code"
author: "Megan Mason, Gwen Hammond, and Ryan Jensen"
date: "2025-03-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## DS 2020 Final Project: Do American Lifestyles correlate with how you like your steak?

## The Data Set

-   This data set looks at factors and risky behaviors that are found in the American lifestyle. The purpose of this data set is to predict how lifestyle choices correlate with how Americans like there steak. The data set contains 551 observations and has 15 variables which are mainly categorical.

## Cleaning the Data

-   Megan started off cleaning the data by re-names the columns so that they are easier to work with.

-   Gwen created a subset of the data where missing values are excluded.

-   Ryan created subsets of people who do eat steak and who don't eat steak.

```{r include=FALSE}
#Megan's Code 
library(readr)
steak <- read.csv("https://raw.githubusercontent.com/fivethirtyeight/data/refs/heads/master/steak-survey/steak-risk-survey.csv", stringsAsFactors = FALSE)

names(steak)[names(steak) == "Consider.the.following.hypothetical.situations...br.In.Lottery.A..you.have.a.50..chance.of.success..with.a.payout.of..100...br.In.Lottery.B..you.have.a.90..chance.of.success..with.a.payout.of..20...br..br.Assuming.you.have..10.to.bet..would.you.play.Lottery.A.or.Lottery.B."] <- "Lottery"
names(steak)[names(steak) == "Do.you.ever.smoke.cigarettes."] <- "Smoke.Cigarettes"
names(steak)[names(steak) == "Do.you.ever.drink.alcohol."] <- "Drink.Alcohol"
names(steak)[names(steak) == "Do.you.ever.gamble."] <- "Gamble"
names(steak)[names(steak) == "Have.you.ever.been.skydiving."] <- "Skydiving"
names(steak)[names(steak) == "Do.you.ever.drive.above.the.speed.limit."] <- "Speed"
names(steak)[names(steak) == "Have.you.ever.cheated.on.your.significant.other."] <- "Affair"
names(steak)[names(steak) == "How.do.you.like.your.steak.prepared."] <- "Prepared"
names(steak)[names(steak) == "Do.you.eat.steak."] <- "Consume.Steak"
names(steak)[names(steak) == "Location..Census.Region."] <- "Location"

```

```{r}
#Gwen's Code
clean_steak <- steak[complete.cases(steak), ]

anyNA(clean_steak)


```

```{r}
#Ryan's Code
library(tidyverse)
eat_steak <- clean_steak %>% 
  filter(Consume.Steak == "Yes")

no_steak <- clean_steak %>% 
  filter(Consume.Steak == "No")

# View(eat_steak)
# View(no_steak)
  
```

## Questions:

Some potential questions that we are interested in examining are:

-   How does household income affect whether individuals eat steak?

-   How does age affect how individuals like their steak prepared?

-   How does drinking alcohol and smoking cigarettes influence how those prefer their steak prepared?

```{r echo=FALSE}
#Megan's code: Looking at cheating vs steak prepared
library(ggplot2)
affairYes <- eat_steak %>%
  filter(!is.na(Affair)) %>%
  filter(!(is.na(Consume.Steak))) %>%
  count(`Affair`) %>%
  mutate(percentage = n / sum(n))
affairYes

affairNo <- no_steak %>%
  filter(!is.na(Affair)) %>%
  filter(!(is.na(Consume.Steak))) %>%
  count(`Affair`) %>%
  mutate(percentage = n / sum(n))
affairNo

clean_steak %>%
  filter(Affair != '') %>%
  filter(`Consume.Steak` != "") %>%
  group_by(`Consume.Steak`) %>%
  count(Affair) %>%
  mutate(percentage_total = n / sum(n)) %>%
  ggplot(aes(x=factor(`Consume.Steak`), y=percentage_total, fill=Affair)) +
  geom_col(position="dodge") +
  theme_minimal() +
  labs(x="consume steak", y="percentage", fill="affair")

clean_steak$Education <- factor(clean_steak$Education, 
                             levels = c('Less than high school degree', 'High school degree', 'Some college or Associate degree', 'Bachelor degree', 'Graduate degree'))
clean_steak$Location <- factor(clean_steak$Location,
                             levels = c("New England","Middle Atlantic", "South Atlantic", "East North Central", "East South Central", "West South Central", "West North Central",  "Mountain", "Pacific", ""))
clean_steak %>%
  filter(Education != '') %>%
  filter(`Consume.Steak` != "") %>%
  group_by(Education) %>%
  count(`Consume.Steak`) %>%
  mutate(percentage_total = n / sum(n)) %>%
  ggplot(aes(x=factor(Education), y=percentage_total, fill=`Consume.Steak`)) +
  geom_col(position="dodge") +
  coord_flip() +
  theme_minimal() +
  labs(x="Education", y="Percentage", fill="Eat Steak")

clean_steak %>%
  filter(Location != '') %>%
  filter(`Consume.Steak` != "") %>%
  group_by(Location) %>%
  count(`Consume.Steak`) %>%
  mutate(percentage_total = n / sum(n)) %>%
  ggplot(aes(x=factor(Location), y=percentage_total, fill=`Consume.Steak`)) +
  geom_col(position="dodge") +
  coord_flip() +
  theme_minimal() +
  labs(x="Location", y="Percentage", fill="Eat Steak")



eat_steak$Prepared <- factor(eat_steak$Prepared, 
                             levels = c('Rare', 'Medium rare', 'Medium', 'Medium Well', 'Well'))
eat_steak$Education <- factor(eat_steak$Education, 
                             levels = c('Less than high school degree', 'High school degree', 'Some college or Associate degree', 'Bachelor degree', 'Graduate degree'))

print(unique(eat_steak$Location))
eat_steak$Location <- factor(eat_steak$Location,
                             levels = c("New England","Middle Atlantic", "South Atlantic", "East North Central", "East South Central", "West South Central", "West North Central",  "Mountain", "Pacific", ""))
eat_steak %>%
  filter(Affair != '') %>%
  filter(`Consume.Steak` != "") %>%
  group_by(Affair) %>%
  count(Prepared) %>%
  mutate(percentage_prepared = n / sum(n)) %>% 
  ggplot(aes(x=factor(Affair), y=percentage_prepared, fill=Prepared)) +
  geom_col(position="dodge") +
  theme_minimal() +
  labs(x="affair", y="percentage", fill="how do you like it prepared")

eat_steak %>%
  filter(Education != '') %>%
  filter(`Consume.Steak` != "") %>%
  group_by(Education) %>%
  count(Prepared) %>%
  mutate(percentage_prepared = n / sum(n)) %>% 
  ggplot(aes(x=factor(Education), y=percentage_prepared, fill=Prepared)) +
  geom_col(position="dodge") +
  coord_flip() +
  theme_minimal() +
  labs(x="education", y="percentage", fill="how do you like it prepared")

eat_steak %>%
  filter(Location != '') %>%
  filter(`Consume.Steak` != "") %>%
  group_by(Location) %>%
  count(Prepared) %>%
  mutate(percentage_prepared = n / sum(n)) %>% 
  ggplot(aes(x=factor(Location), y=percentage_prepared, fill=Prepared)) +
  geom_col(position="dodge") +
  coord_flip() +
  theme_minimal() +
  labs(x="Location", y="percentage", fill="how do you like it prepared")

 
```

```{r}
# Gwen's Code 
### 1. Gender vs Steak Consumption and Preparation --------------------------

# Filter out blanks and NAs
clean_steak_filtered <- clean_steak %>%
  filter(
    !is.na(Age) & Age != "",
    !is.na(Gender) & Gender != "",
    !is.na(Gamble) & Gamble != "",
    !is.na(Consume.Steak) & Consume.Steak != ""
  )


ggplot(clean_steak_filtered, aes(x = factor(Age), fill = Consume.Steak)) +
  geom_bar(position = "dodge") +
  theme_minimal() +
  labs(
    x = "Age",
    y = "Count",
    fill = "Eat Steak",
    title = "Age vs Eat Steak (Yes vs No)"
  )

ggplot(clean_steak_filtered, aes(x = factor(Age), fill = Prepared)) +
  geom_bar(position = "dodge") +
  theme_minimal() +
  labs(
    x = "Age",
    y = "Count",
    fill = "Prepared",
    title = "Age vs How You Like It Prepared"
  )

ggplot(clean_steak_filtered, aes(x = Gender, fill = Consume.Steak)) +
  geom_bar(position = "dodge") +
  theme_minimal() +
  labs(
    x = "Gender",
    y = "Count",
    fill = "Eat Steak",
    title = "Gender vs Eat Steak (Yes vs No)"
  )

ggplot(clean_steak_filtered, aes(x = Gender, fill = Prepared)) +
  geom_bar(position = "dodge") +
  theme_minimal() +
  labs(
    x = "Gender",
    y = "Count",
    fill = "Prepared",
    title = "Gender vs How You Like It Prepared"
  )

ggplot(clean_steak_filtered, aes(x = Gamble, fill = Consume.Steak)) +
  geom_bar(position = "dodge") +
  theme_minimal() +
  labs(
    x = "Gamble",
    y = "Count",
    fill = "Eat Steak",
    title = "Gambling vs Eat Steak (Yes vs No)"
  )

ggplot(clean_steak_filtered, aes(x = Gamble, fill = Prepared)) +
  geom_bar(position = "dodge") +
  theme_minimal() +
  labs(
    x = "Gamble",
    y = "Count",
    fill = "Prepared",
    title = "Gambling vs How You Like It Prepared"
  )
```

Ryan's Code:
```{r}
noNA_Income <- clean_steak %>% 
  filter(!(Household.Income == "")) 
total_rows <- nrow(noNA_Income)

noNA_Income %>% 
  mutate(Household.Income = factor(Household.Income, levels = c("$0 - $24,999", "$25,000 - $49,999", "$50,000 - $99,999", "$100,000 - $149,999", "$150,000+"))) %>% 
  group_by(Household.Income) %>% 
  summarise(
    group_percent = n() / total_rows
  ) %>% 
  ggplot(aes(x = "", y = group_percent, fill = Household.Income)) + 
  geom_bar(width = 1, stat = "identity") + coord_polar("y") + theme_void() + labs(title = "Percentage of Respondents in Income Group", fill = "Household Income Group")
  
```

Analyzing the pie chart of the percentages of respondents in each income category, it is clear the category from $50,000-$99,000 has a much greater number of respondents then the other 4 categories. The other 4 income categories are all mostly similar in the percent of respondents in the category. This must be considered when analyzing if respondents consume steak and how they prefer it prepared within each income group. 


```{r}
clean_steak %>% 
  filter(!Household.Income == "", !Consume.Steak == "") %>% 
  mutate(Household.Income = factor(Household.Income, levels = c("$0 - $24,999", "$25,000 - $49,999", "$50,000 - $99,999", "$100,000 - $149,999", "$150,000+"))) %>% 
  group_by(
    Household.Income, Consume.Steak
  ) %>% 
  summarise(
    eat_steak = n()
  ) %>% 
  ggplot(aes(x = Household.Income, y = eat_steak, fill = Consume.Steak)) + geom_col() + labs(x = "Household Income", y = "Number of Respondents", fill = "Consume Steak", title = "Household Income vs If Individual Consumes Steak") + coord_flip()
```

There appears to be no true relationship between the household income of the individual and if they consume steak. All bars appear to have a majority of individuals who consume steak, and there appears to be no trend between the income and amount of individuals who do or do not consume steak. 

```{r}
eat_steak %>% 
  filter(!Household.Income == "", !is.na(Prepared)) %>% 
  mutate(Household.Income = factor(Household.Income, levels = c("$0 - $24,999", "$25,000 - $49,999", "$50,000 - $99,999", "$100,000 - $149,999", "$150,000+"))) %>% 
  mutate(Prepared = factor(Prepared, levels = c("Rare", "Medium rare", "Medium", "Medium Well", "Well"))) %>% 
  group_by(Household.Income, Prepared) %>% 
  summarise(
    prepared_number = n()
  ) %>% 
  ggplot(aes(x = Household.Income, y = prepared_number, fill = Prepared)) + geom_col() + coord_flip() + labs(x = "Household Income", y = "Number of Respondents", fill = "Prepared Preference", title = "Household Income vs. Preference on Preparation of Steak")
```

The relationship between how individuals prefer their steak prepared does not appear to differ based on household income. There are some slight variations, but no overall trends that appear to stand out. 

Overall it does not appear that household income affects whether and individuals eats steak and how they prefer it to be prepared. 


```{r}
noNA_alcohol_smoke <- clean_steak %>% 
  filter(!Drink.Alcohol == "" & !Smoke.Cigarettes == "")
total_rows <- nrow(noNA_alcohol_smoke)

noNA_alcohol_smoke %>% 
  group_by(Drink.Alcohol, Smoke.Cigarettes) %>% 
  summarise(
    group_percent = n() / total_rows
  ) %>% 
  ggplot(aes(x = "", y = group_percent, fill = interaction(Drink.Alcohol,Smoke.Cigarettes))) +
  geom_bar(width = 1, stat = "identity") + coord_polar("y") + theme_void() + labs(fill = "Respondents Drink and/or Smoke Respectively", title = "Percentage of Respondents Who Drink and/or Smoke Cigarettes")

```

Looking at this summary, we can see that a greater majority of respondents reported that they drink alcohol but do not smoke. There is a very little amount of respondents who reported that they do not drink but do smoke. These differences will be considered when analyzing the relationship between whether they eat steak. 


```{r}
noNA_alcohol_smoke %>% 
  filter(!Consume.Steak == "") %>% 
  group_by(Drink.Alcohol, Smoke.Cigarettes, Consume.Steak) %>% 
  summarise(
    steak_count = n()
  ) %>% 
  ggplot(aes(x = interaction(Drink.Alcohol,Smoke.Cigarettes), y = steak_count, fill = Consume.Steak)) + geom_col() + labs(title = "Drink Alcohol and/or Smoke Cigarettes vs. Whether Respondent Consumes Steak", x = "Drink Alcohol and/or Smoke Cigarettes Respectively", y = "Number of Respondents", fill = "Whether Respondent Consumes Steak")
```

Analyzing the relationship between whether respondents smoke cigarettes and/or drink alcohol, there does not appear to be any major trends between the two. Respondents in all four categories tend to respond that they do consume steak. 

```{r}
noNA_alcohol_smoke %>% 
  filter(!Prepared == "" & Consume.Steak == "Yes") %>% 
   mutate(Prepared = factor(Prepared, levels = c("Rare", "Medium rare", "Medium", "Medium Well", "Well"))) %>% 
  group_by(Drink.Alcohol, Smoke.Cigarettes, Prepared) %>% 
  summarise(
    totals_Prepared = n() 
  ) %>% 
  ggplot(aes(x = interaction(Drink.Alcohol, Smoke.Cigarettes), y = totals_Prepared, fill = Prepared)) + geom_col() + labs(title = "Drink Alcohol and/or Smoke Cigarettes vs Preference of Steak Preparation", x = "Drink Alcohol and/or Smoke Cigarettes Respectively", y = "Number of Respondents", fill = "Preparation Preference")
  
```

Analyzing the bar chart, there does appear to be a slight difference in the relative number of respondents within the four groups and how they prefer their steak prepared. In the No,No and Yes,Yes categories, Medium Rare and Medium look to have about the same number of respondents relative to their categories. In the Yes,No category, Medium Rare appears to be slightly more popular within the category. Rare and Well appear to be the least selected in all four groups by a significant amount.

Overall, there appears to be very slight differences between the four groups based on whether they drink alcohol and/or smoke cigarettes, and whether they respondents consume steak, and if they do, how they prefer their steak prepared. 
